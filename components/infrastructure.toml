#:schema https://api.nuon.co/v1/general/config-schema?source=component_config

# Thanksgiving Meal Planner - ECS Infrastructure Component
# This component provisions AWS ECS infrastructure

name               = "ecs_infrastructure"
type               = "terraform_module"
terraform_version  = "1.11.4"
dependencies       = ["thanksgiving_app"]

# Reference the Terraform module in this repository
[public_repo]
repo      = "matt-zach-s/ecs-saas-app"
directory = "terraform"
branch    = "main"

# Terraform variables (using new vars format)
# These will be passed to the Terraform module
[vars]
# Get AWS region from sandbox outputs
aws_region = "{{.nuon.cloud_account.aws.region}}"

# Application configuration
app_name       = "thanksgiving-meal-planner"
environment    = "production"
container_port = "5000"
desired_count  = "2"
task_cpu       = "256"
task_memory    = "512"

# The full container image URL comes from the docker component
# This references the output from the thanksgiving_app component
container_image_url = "{{.nuon.components.thanksgiving_app.outputs.image.repository}}:{{.nuon.components.thanksgiving_app.outputs.image.tag}}"
